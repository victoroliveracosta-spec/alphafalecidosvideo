<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homenagem Alphacampus</title>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: #004d40; 
            background-image: url('background.jpeg'); 
            background-size: contain; 
            background-position: center; 
            background-repeat: no-repeat; 
            color: #D4B851; 
            font-family: Arial, sans-serif; 
            height: 100vh; 
            overflow: hidden; 
            text-align: center; 
            position: relative; 
            display: flex;
            flex-direction: column;
            justify-content: space-between; 
            align-items: center;
        }

        /* Contêiner principal que ocupa o espaço central */
        #name-container { 
            flex-grow: 1; 
            width: 100%;
            position: relative; /* Necessário para o posicionamento absoluto do #name-area */
            overflow: hidden;
            margin: 0; 
            height: 100%;
        }

        /* Área de posicionamento dos nomes, ajustada para evitar os logos */
        #name-area {
            position: absolute;
            /* Inicia 20% abaixo do topo para evitar o logo Alphacampus */
            top: 20%; 
            /* Inicia 30% a partir da esquerda para evitar o logo Alphacampus */
            left: 30%; 
            /* Largura de 45% para deixar uma margem de 25% à direita, evitando o logo 'raizes' */
            width: 45%; 
            /* Altura de 50% para deixar uma margem de 30% na base, evitando o logo 'raizes' */
            height: 50%;
            
            /* Opcional: descomente a linha abaixo para visualizar a área de nomes */
            /* border: 1px solid red; */
        }

        /* Estilo para cada nome (estrela) */
        .star-name {
            position: absolute; 
            font-size: 2.5vh; 
            font-weight: 700; 
            color: #D4B851; 
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
            opacity: 0; 
            transition: opacity 1s ease-in-out;
            white-space: nowrap; 
            cursor: default;
        }

        .star-name.visible {
            opacity: 1;
        }
        
        @keyframes star-float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); } 
            100% { transform: translateY(0px); }
        }

        .star-name.animated {
            animation: star-float 5s ease-in-out infinite alternate;
        }

        /* Estilos dos botões */
        button { 
            padding: 12px 30px; 
            font-size: 1.2vw; 
            font-weight: bold; 
            color: #D4B851; 
            background-color: #004d40; 
            border: 2px solid #D4B851; 
            border-radius: 5px; 
            cursor: pointer; 
            transition: background-color 0.3s ease, transform 0.2s ease; 
            font-family: Arial, sans-serif; 
        }
        button:hover { 
            background-color: #00332b; 
            transform: scale(1.05); 
        }
        button:active { transform: scale(0.95); }
        button:disabled { background-color: #999; cursor: not-allowed; opacity: 0.6; }

        #button-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
            width: 100%;
            padding: 20px 0; 
            min-height: 50px; 
            opacity: 1;
            transition: opacity 0.3s ease;
            pointer-events: auto;
            order: 2; 
        }
        
        .hidden-controls {
            opacity: 0 !important; 
            pointer-events: none !important;
        }

        #button-container:hover {
            opacity: 1 !important; 
            pointer-events: auto !important;
        }
        
        #button-container button {
            transition: none;
        }
    </style>
</head>
<body>
    <!-- O container principal agora envolve o #name-area -->
    <div id="name-container">
        <!-- NOVO: Área onde os nomes serão posicionados -->
        <div id="name-area">Carregando nomes...</div>
    </div>

    <!-- Container dos botões na parte de baixo -->
    <div id="button-container" class="hidden-controls">
        <button id="play-btn" disabled>▶ Iniciar Homenagem</button>
        <button id="pause-btn" disabled>⏸ Pausar</button>
        <button id="fullscreen-btn">⛶ Tela Cheia</button>
    </div>

    <script>
        let names = [];
        // CORRIGIDO: O container agora é o #name-area
        const container = document.getElementById('name-area'); 
        const playBtn = document.getElementById('play-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const fullscreenBtn = document.getElementById('fullscreen-btn'); 
        const buttonContainer = document.getElementById('button-container'); 

        let isPlaying = false;
        let timeoutId = null;
        
        // Armazena as posições atuais (para evitar sobreposição)
        let activeStars = [];

        // Intervalo de tempo entre a criação de cada nome (3.0 segundos)
        const creationInterval = 3000; 
        // Tempo que cada nome permanece na tela (15.0 segundos)
        const displayDuration = 15000; 

        /**
         * Processa a string de nome e localização para retornar apenas o nome.
         */
        function parseNameAndLocation(fullString) {
            const parts = fullString.split(' - ');
            const name = parts[0] || 'Nome Desconhecido';
            return { name, location: "" };
        }

        // NOVO: Verifica se um novo nome sobrepõe outro
        function isOverlapping(x, y, width, height) {
            for (const star of activeStars) {
                // As coordenadas x e y são relativas ao #name-area
                const buffer = 20; // espaço mínimo entre nomes
                
                const starX = parseFloat(star.style.left);
                const starY = parseFloat(star.style.top);
                const starWidth = star.offsetWidth;
                const starHeight = star.offsetHeight;

                if (
                    x < starX + starWidth + buffer &&
                    x + width + buffer > starX &&
                    y < starY + starHeight + buffer &&
                    y + height + buffer > starY
                ) {
                    return true;
                }
            }
            return false;
        }

        /**
         * Função para criar uma "estrela" (nome) na área do container.
         */
        function createStar(name) {
            const star = document.createElement("div");
            star.className = "star-name";
            star.textContent = name;
            
            // Adiciona ao container temporariamente para calcular o tamanho
            container.appendChild(star);

            const containerWidth = container.offsetWidth;
            const containerHeight = container.offsetHeight;
            
            // Calcula largura e altura do texto
            const width = star.offsetWidth;
            const height = star.offsetHeight;
            
            let x, y, tries = 0;
            do {
                // Gera coordenadas aleatórias dentro do container #name-area
                x = Math.random() * (containerWidth - width);
                y = Math.random() * (containerHeight - height);
                
                tries++;
                if (tries > 50) break; // Aumentado o limite de tentativas para melhor distribuição
            } while (isOverlapping(x, y, width, height));
            
            // Se não encontrou uma posição sem sobreposição após 50 tentativas, remove e não exibe
            if (tries > 50) {
                container.removeChild(star);
                return;
            }

            star.style.left = `${x}px`;
            star.style.top = `${y}px`;

            // Animação de fade-in
            setTimeout(() => {
                star.classList.add("visible");
                star.classList.add("animated");
            }, 100);
            
            // Adiciona a estrela à lista de ativas
            activeStars.push(star);

            // Remove a estrela após o tempo de exibição (displayDuration)
            setTimeout(() => {
                star.classList.remove("visible");
                setTimeout(() => {
                    if(container.contains(star)) {
                        container.removeChild(star);
                        // Remove da lista de ativas
                        activeStars = activeStars.filter(s => s !== star);
                    }
                }, 1000); // Espera a transição de fade-out (1 segundo)
            }, displayDuration); 
        }

        /**
         * Função para iniciar o "Céu Estrelado"
         */
        function startStarrySky() {
            if (!isPlaying || names.length === 0) return;

            // Pega um nome aleatório da lista
            const randomIndex = Math.floor(Math.random() * names.length);
            const nameData = names[randomIndex];
            const { name } = parseNameAndLocation(nameData);

            // Cria a estrela
            createStar(name);

            // Cria a próxima estrela após o intervalo (creationInterval)
            timeoutId = setTimeout(startStarrySky, creationInterval); 
        }

        // Carrega os nomes do arquivo JSON
        fetch('names.json') 
            .then(response => {
                if (!response.ok) {
                    throw new Error('Erro ao carregar names.json: ' + response.statusText);
                }
                return response.json(); 
            })
            .then(data => {
                names = data; 
                
                if (names.length > 0) {
                    container.textContent = ""; // Limpa a mensagem de "Carregando nomes..."
                } else {
                    container.textContent = "Lista de nomes vazia.";
                }
                
                playBtn.disabled = false;
                pauseBtn.disabled = true;
            })
            .catch(error => {
                console.error("Erro ao carregar a lista de nomes:", error);
                container.textContent = "Erro ao carregar nomes. Verifique se o arquivo names.json está na mesma pasta.";
            });

        // Função para mostrar os botões
        function showButtons() {
            buttonContainer.classList.remove('hidden-controls');
        }

        // Função para ocultar os botões
        function hideButtons() {
            buttonContainer.classList.add('hidden-controls');
        }

        // Função para alternar o modo de tela cheia
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                fullscreenBtn.innerHTML = "⛶ Sair da Tela Cheia";
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    fullscreenBtn.innerHTML = "⛶ Tela Cheia";
                }
            }
        }

        function play() {
            if (isPlaying) return;
            
            isPlaying = true;
            playBtn.disabled = true;
            pauseBtn.disabled = false;
            hideButtons(); 
            
            // Limpa qualquer timeout anterior
            if (timeoutId) clearTimeout(timeoutId);
            
            // Inicia o ciclo de estrelas
            startStarrySky();
        }

        function pause() {
            if (!isPlaying) return;
            isPlaying = false;
            playBtn.disabled = false;
            pauseBtn.disabled = true;
            showButtons(); 
            
            if (timeoutId) clearTimeout(timeoutId); 
        }

        playBtn.addEventListener('click', play);
        pauseBtn.addEventListener('click', pause);
        fullscreenBtn.addEventListener('click', toggleFullscreen); 
        
        // Mostra os botões inicialmente para permitir o primeiro play
        showButtons();
        
        // Adiciona um listener para quando sair do modo tela cheia para mostrar os botões
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                showButtons();
                if (isPlaying) {
                    pause();
                }
            } else {
                if (isPlaying) {
                    hideButtons();
                }
            }
        });
    </script>
</body>
</html>
